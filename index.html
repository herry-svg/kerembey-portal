<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KeremBey Portal Final</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --bg: #0f0c29; --card: rgba(255,255,255,0.1); --text: #fff; --accent: #00d2ff; }
        body.light { --bg: #f0f2f5; --card: #fff; --text: #333; --accent: #3a7bd5; }
        body.dark { --bg: #0f0c29; --card: rgba(255,255,255,0.1); --text: #fff; --accent: #00d2ff; }
        body.gold { --bg: #1a1a1a; --card: rgba(255,215,0,0.1); --text: #ffd700; --accent: #ffcc00; }
        
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; transition: 0.3s; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; }
        
        /* CANLI SAAT TASARIMI */
        #live-clock { position: fixed; top: 20px; right: 20px; background: rgba(0,0,0,0.6); padding: 10px 20px; border-radius: 50px; border: 1px solid var(--accent); color: var(--accent); font-family: 'Courier New', monospace; font-size: 1.2rem; font-weight: bold; box-shadow: 0 0 15px var(--accent); z-index: 1000; letter-spacing: 2px; }

        .box { background: var(--card); padding: 30px; border-radius: 20px; width: 320px; backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1); text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: none; background: rgba(255,255,255,0.2); color: #fff; box-sizing: border-box; outline: none; }
        button { width: 100%; padding: 12px; border: none; border-radius: 8px; background: var(--accent); color: #fff; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.2s; }
        button:hover { opacity: 0.8; transform: translateY(-2px); }
        .hidden { display: none; }
        .menu-btn { margin-bottom: 10px; background: rgba(255,255,255,0.05); text-align: left; padding: 15px; border-left: 4px solid var(--accent); font-size: 16px; }
        .target-item { background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; margin-bottom: 10px; text-align: left; border-left: 3px solid var(--accent); }
        .date { font-size: 10px; opacity: 0.6; display: block; margin-top: 5px; color: var(--accent); }
        .admin-user { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); text-align: left; }
    </style>
</head>
<body class="dark">

<div id="live-clock">00:00:00</div>

<div id="auth-screen" class="box">
    <h2 id="auth-title">HoÅŸ Geldin</h2>
    <input type="text" id="user-in" placeholder="KullanÄ±cÄ± AdÄ±">
    <input type="password" id="pass-in" placeholder="Åifre">
    <p id="error-msg" style="color:#ff4b2b; font-size:12px;"></p>
    <button onclick="authAction()">GiriÅŸ Yap / KayÄ±t Ol</button>
    <p onclick="toggleAuth()" style="cursor:pointer; font-size:12px; margin-top:15px; text-decoration: underline;">Modu DeÄŸiÅŸtir (GiriÅŸ/KayÄ±t)</p>
</div>

<div id="main-menu" class="box hidden">
    <h2 id="welcome-msg" style="color: var(--accent);"></h2>
    <button class="menu-btn" onclick="showSection('sec-target')">ğŸ¯ 1. Hedef Takip</button>
    <button class="menu-btn" onclick="showSection('sec-info')">ğŸ‘¤ 2. KullanÄ±cÄ± Bilgileri</button>
    <button class="menu-btn" onclick="showSection('sec-theme')">ğŸ¨ 3. Tema DeÄŸiÅŸtirme</button>
    <button id="admin-btn" class="menu-btn hidden" onclick="showSection('sec-admin')" style="border-left-color: #ffd700; color: #ffd700;">ğŸ‘‘ 4. YÃ¶netim Paneli</button>
    <button onclick="location.reload()" style="background:#ff4b2b; margin-top: 20px;">GÃ¼venli Ã‡Ä±kÄ±ÅŸ</button>
</div>

<div id="sec-target" class="box hidden">
    <h3>Hedeflerim</h3>
    <input type="text" id="target-in" placeholder="Hedefini buraya yaz...">
    <button onclick="addTarget()">Ekle</button>
    <div id="target-list" style="margin-top:20px; max-height: 200px; overflow-y: auto;"></div>
    <button onclick="showSection('main-menu')" style="background:gray;">Geri DÃ¶n</button>
</div>

<div id="sec-info" class="box hidden">
    <h3>Profilim</h3>
    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px;">
        <p id="prof-name" style="font-weight: bold;"></p>
        <p id="prof-status">StatÃ¼: Standart Ãœye</p>
    </div>
    <button onclick="showSection('main-menu')" style="background:gray; margin-top:15px;">Geri DÃ¶n</button>
</div>

<div id="sec-theme" class="box hidden">
    <h3>Tema SeÃ§iniz</h3>
    <button onclick="setTheme('dark')">ğŸŒŒ Koyu Mod</button>
    <button onclick="setTheme('light')" style="background:#3a7bd5">ğŸŒ¤ï¸ AydÄ±nlÄ±k Mod</button>
    <button onclick="setTheme('gold')" style="background:#ffd700; color:#000">âœ¨ AltÄ±n Mod</button>
    <button onclick="showSection('main-menu')" style="background:gray; margin-top:15px;">Geri DÃ¶n</button>
</div>

<div id="sec-admin" class="box hidden">
    <h3>KayÄ±tlÄ± KullanÄ±cÄ±lar</h3>
    <div id="user-list" style="max-height: 250px; overflow-y: auto;"></div>
    <button onclick="showSection('main-menu')" style="background:gray; margin-top:15px;">Geri DÃ¶n</button>
</div>

<script>
    // ğŸ”¥ CANLI SAAT
    function updateClock() {
        const now = new Date();
        document.getElementById('live-clock').innerText = now.toLocaleTimeString('tr-TR');
    }
    setInterval(updateClock, 1000);
    updateClock();

    // ğŸ”¥ FIREBASE - BURAYI KENDÄ° BÄ°LGÄ°LERÄ°NLE DOLDUR
    const firebaseConfig = {
        apiKey: "AIzaSyB1H_o80FeXzl_eCEqtKhSa13GKyox5EcA",
        databaseURL: "https://kerembeyportal-default-rtdb.firebaseio.com"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let isLogin = true;
    let currentUser = "";

    function toggleAuth() { 
        isLogin = !isLogin; 
        document.getElementById('auth-title').innerText = isLogin ? "GiriÅŸ Yap" : "KayÄ±t Ol";
    }

    function authAction() {
        const u = document.getElementById('user-in').value.trim();
        const p = document.getElementById('pass-in').value;
        const err = document.getElementById('error-msg');
        err.innerText = "";

        // Admin KontrolÃ¼
        if(u === "KeremBey" && p === "521200369") { loginSuccess("KeremBey", true); return; }

        if(isLogin) {
            db.ref('users/' + u).once('value').then((s) => {
                if(s.exists() && s.val().pass === p) loginSuccess(u, false);
                else err.innerText = "KullanÄ±cÄ± adÄ± veya ÅŸifre hatalÄ±!";
            });
        } else {
            // KayÄ±t KurallarÄ±
            if(u.length <= 3) return err.innerText = "Ä°sim 3 harften fazla olmalÄ±!";
            if(p.length <= 4) return err.innerText = "Åifre 4 sayÄ±dan fazla olmalÄ±!";
            
            db.ref('users/' + u).once('value').then((s) => {
                if(s.exists()) { err.innerText = "Bu isim zaten alÄ±nmÄ±ÅŸ!"; }
                else {
                    db.ref('users/' + u).set({ user: u, pass: p }).then(() => {
                        alert("BaÅŸarÄ±yla kayÄ±t oldun! Åimdi giriÅŸ yap."); toggleAuth();
                    });
                }
            });
        }
    }

    function loginSuccess(name, isAdmin) {
        currentUser = name;
        document.getElementById('auth-screen').classList.add('hidden');
        document.getElementById('main-menu').classList.remove('hidden');
        document.getElementById('welcome-msg').innerText = "Selam, " + name;
        document.getElementById('prof-name').innerText = "KullanÄ±cÄ±: " + name;
        if(isAdmin) {
            document.getElementById('admin-btn').classList.remove('hidden');
            document.getElementById('prof-status').innerText = "StatÃ¼: YÃ¶netici ğŸ‘‘";
            renderAdmin();
        }
        renderTargets();
    }

    function addTarget() {
        const val = document.getElementById('target-in').value;
        if(!val) return;
        const time = new Date().toLocaleString('tr-TR');
        db.ref('targets/' + currentUser).push({ text: val, date: time }).then(() => {
            document.getElementById('target-in').value = "";
        });
    }

    function renderTargets() {
        db.ref('targets/' + currentUser).on('value', (s) => {
            const list = document.getElementById('target-list');
            list.innerHTML = "";
            s.forEach((child) => {
                list.innerHTML += `<div class="target-item">${child.val().text}<span class="date">ğŸ“… ${child.val().date}</span></div>`;
            });
        });
    }

    function renderAdmin() {
        db.ref('users').on('value', (s) => {
            const list = document.getElementById('user-list');
            list.innerHTML = "";
            s.forEach((child) => {
                list.innerHTML += `<div class="admin-user">ğŸ‘¤ <b>${child.val().user}</b><br>ğŸ”‘ Åifre: ${child.val().pass}</div>`;
            });
        });
    }

    function showSection(id) {
        document.querySelectorAll('.box').forEach(x => x.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    function setTheme(t) { document.body.className = t; }
</script>

</body>
</html>
